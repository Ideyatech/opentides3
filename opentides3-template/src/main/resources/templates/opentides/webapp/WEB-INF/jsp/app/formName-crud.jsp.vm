<%--
	- CRUD page for ${bean.displayName}.
	- Scaffold generated by opentides3 on ${dateToday}. 
	- @author opentides
--%>
<%@ page contentType="text/html;utf-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="app" tagdir="/WEB-INF/tags"%>
<%@ taglib prefix="tides" uri="http://www.ideyatech.com/tides"%>

<app:header pageTitle="label.${bean.formName}" active="${bean.formName}" />

<ul class="breadcrumb">
	<li><a href="${home}"><spring:message code="label.home" /></a> <span class="divider">/</span></li>
	<li class="active"><spring:message code="label.${bean.formName}" /></li>
</ul>

<div id="${bean.formName}-body" class="container">
<div id="search-body">
	<div id="search-panel" class="span3">
		<div id="search-panel-inner">
			<div class="navbar">
				<div class="navbar-inner">
					<span class="brand"><i class="icon-search"></i><spring:message code="label.search" /></span>
					<a class="show-search-form btn collapsed pull-right hidden-desktop hidden-tablet" data-toggle="collapse" data-target=".search-form">
						<i class="icon-chevron-up"></i>
						<i class="icon-chevron-down"></i>
					</a>
				</div>
			</div>
			<div class="search-form collapse">
				<form:form modelAttribute="searchCommand" id="${bean.formName}-search" cssCLass="form-horizontal">
#foreach( ${field} in ${bean.fields} )
#if ( ${field.getAttribute("isSearchCriteria")} && ${field.getAttribute("type")} != "" && ${field.getLabel()} != "")
					<tides:${field.getAttribute("type").toString().replace('"', "")} path="${field.getFieldName()}" label="label.${bean.formName}.${field.getLabelCode()}"#if(${field.isByOptions()} == true || ${field.isByCategory()} == true) items="#[[${]]#${field.fieldName}List#[[}]]#"#end#if(${field.isByCategory()} == true) itemLabel="value" itemValue="key"#end#if(${field.getAttribute("isMultiple")} == true) multiple="true"#end#if(${field.getAttribute("date_format")}!="") format=${field.getAttribute("date_format")}#end />
#end
#end
					<hr/>
					<input type="submit" class="btn btn-info btn-block" data-submit="search" value="<spring:message code="label.search"/>">
					<button type="button" class="btn btn-link btn-block" data-submit="clear"><spring:message code="label.clear" /></button>
				</form:form>
			</div>
		</div>
	</div>
	
	<div id="results-panel" class="span9">
		<div id="message-panel" class="row-fluid">
			<button id="${bean.formName}-add" class="btn btn-info add-action">
				<i class="icon-plus-sign icon-white"></i>
				<spring:message code="label.${bean.formName}.add" />
			</button>
			<div class="status" data-display-pagelinks="false" data-display-summary="true" data-summary-message='
				<spring:message code="message.displaying-x-of-y" arguments="${symbol_pound}start,${symbol_pound}end,${symbol_pound}total,records"/>
			'>
				<tides:status results="${results}" />
			</div>
		</div>
		
		<div class="clear"></div>
		
		<div class="table-wrapper-2 overflow-hidden">
			<div class="table-wrapper">
				<table id="${bean.formName}-results" class="footable table-bordered table-striped table-hover table-condensed" data-page="${results.currPage}" >
					<thead>
						<tr class="table-header">
#foreach( ${field} in ${bean.fields} )
#if ( ${field.getAttribute("isSearchResult")} && ${field.getAttribute("label")} != "")
							<th data-field-name="${field.getFieldName()}"><spring:message code="label.${bean.formName}.${field.getLabelCode()}" /></th>
#end
#end
							<th data-field-name="ot3-controls"></th>
						</tr>
					</thead>
					<tbody>
						<script type="text/template" class="template">
	                		<tr id="${bean.formName}-row-{{id}}" data-id="{{id}}">
#foreach( ${field} in ${bean.fields} )
#if ( ${field.getAttribute("isSearchResult")} && ${field.getAttribute("label")} != "")
								<td>{{${field.getFieldName()}}}</td>
#end
#end
								<td>
									<i class='icon-pencil edit-action' data-id='{{id}}' data-title="<spring:message code="label.edit" />"></i>
									<i class='icon-trash remove-action' data-id='{{id}}' data-title="<spring:message code="label.delete" />"></i>
								</td>
							</tr>
						</script>
						<c:forEach items="${results.results}" var="record" varStatus="status">
							<tr id="${bean.formName}-row-${record.id}" data-id="${record.id}">
#foreach( ${field} in ${bean.fields} )
#if ( ${field.getAttribute("isSearchResult")} && ${field.getAttribute("label")} != "")
								<td>#[[${record.]]#${field.fieldName}#[[}]]#</td>
#end
#end
								<td>
									<i class='icon-pencil edit-action' data-id='${record.id}' data-title="<spring:message code="label.edit" />"></i>
									<i class='icon-trash remove-action' data-id='${record.id}' data-title="<spring:message code="label.delete" />"></i>
								</td>
							</tr>
						</c:forEach>
					</tbody>
				</table>	
			</div>
		</div>

		<div class="paging clearfix">
			<tides:paging results="${results}"/>
		</div>
	</div>	
</div>

<div id="form-body" class="modal fade hide">
	<div id="form-panel" >
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h4 class="${add}"><spring:message code="label.${bean.formName}.add" /></h4>
			<h4 class="${update}"><spring:message code="label.${bean.formName}.update" /></h4>
		</div>

		<form:form modelAttribute="formCommand" id="${bean.formName}-form" cssClass="form-horizontal">
			<div class="modal-body">
				<div class="message-container"></div>
#foreach( ${field} in ${bean.fields} )
#if ( ${field.getAttribute("isForCreation")} && ${field.getAttribute("type")} != "" && ${field.getAttribute("label")} != "")
				<tides:${field.getAttribute("type").toString().replace('"', "")} path="${field.getFieldName()}" label="label.${bean.formName}.${field.getLabelCode()}"#if(${field.isByOptions()} == true || ${field.isByCategory()} == true) items="#[[${]]#${field.fieldName}List#[[}]]#"#end#if(${field.isByCategory()} == true) itemLabel="value" itemValue="key"#end#if(${field.getAttribute("isMultiple")} == true) multiple="true"#end#if(${field.getAttribute("isRequired")} == true) required="true"#end#if(${field.getAttribute("date_format")}!="") format=${field.getAttribute("date_format")}#end />
#end
#end
			</div>
			
			<div class="modal-footer">
				<button type="button" class="btn btn-link" data-dismiss="modal"><spring:message code="label.close" /></button>
				<input type="submit" class="btn btn-info  ${add}" data-form-display="add" data-submit="save-and-new" value="<spring:message code="label.save-and-new" />" />
				<input type="submit" class="btn btn-success" data-submit="save" value="<spring:message code="label.save" />" />
				<input type="hidden" name="id" />
			</div>
		</form:form>
	</div>
</div>
</div>

<tides:footer>
	<script type="text/javascript"><script type="text/javascript">
		$(document).ready(function() {
			$('#${bean.formName}-body').RESTful();
			$('body').tooltip({selector: '.edit-action, .remove-action'});
		});
	</script>
</tides:footer>